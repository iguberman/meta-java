# HG changeset patch
# User mhaupt
# Date 1465400825 -3600
# Node ID 3eab3ce82c31d1332bc383a1a3201eaee220c001
# Parent  aeae865c933d8a38f6764a264d93394178af9f28
8158571: Additional method handle validation
Reviewed-by: jrose, ahgross, mchung

diff -r aeae865c933d -r 3eab3ce82c31 jdk/src/share/classes/java/lang/invoke/MethodHandles.java
--- a/jdk/src/share/classes/java/lang/invoke/MethodHandles.java	Mon Jun 06 11:59:51 2016 -0700
+++ b/jdk/src/share/classes/java/lang/invoke/MethodHandles.java	Wed Jun 08 16:47:05 2016 +0100
@@ -2847,7 +2847,7 @@
         int filterValues = filterType.parameterCount();
         if (filterValues == 0
                 ? (rtype != void.class)
-                : (rtype != filterType.parameterType(0)))
+                : (rtype != filterType.parameterType(0) || filterValues != 1))
             throw newIllegalArgumentException("target and filter types do not match", targetType, filterType);
     }
 
